"use strict";(self["webpackChunkprosonal_health_web"]=self["webpackChunkprosonal_health_web"]||[]).push([[680],{1680:function(e,a,t){t.r(a),t.d(a,{default:function(){return R}});var l=t(641),o=t(3751),s=t(33);const n={class:"book-save-view-container"},i={key:0,class:"word-search"},r={class:"item"},d={key:2,class:"book-save-container"},c={class:"book-save-table"},u={class:"action-buttons"},v=["onClick"],b=["onClick"],g={key:3,class:"pager"},k={class:"dialog-content"},h={class:"form-group"},p={class:"form-label"},f={class:"form-group"},y={class:"form-label"},m={class:"borrow-notice"},C={class:"dialog-footer"};function F(e,a,t,F,_,L){const w=(0,l.g2)("Search"),O=(0,l.g2)("el-icon"),D=(0,l.g2)("el-empty"),R=(0,l.g2)("el-row"),$=(0,l.g2)("Reading"),S=(0,l.g2)("StarFilled"),K=(0,l.g2)("el-pagination"),x=(0,l.g2)("Goods"),z=(0,l.g2)("el-input-number"),V=(0,l.g2)("Calendar"),I=(0,l.g2)("el-date-picker"),E=(0,l.g2)("InfoFilled"),j=(0,l.g2)("el-button"),U=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)("div",n,[0!==F.tableData.length?((0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",r,[(0,l.bF)(O,null,{default:(0,l.k6)(()=>[(0,l.bF)(w)]),_:1}),(0,l.bo)((0,l.Lk)("input",{type:"text",placeholder:"书籍ID","onUpdate:modelValue":a[0]||(a[0]=e=>F.bookSaveQueryDto.bookId=e)},null,512),[[o.Jo,F.bookSaveQueryDto.bookId]]),(0,l.Lk)("span",{class:"search-text",onClick:a[1]||(a[1]=(...e)=>F.fetchFreshData&&F.fetchFreshData(...e))},"搜索")])])):(0,l.Q3)("",!0),0===F.tableData.length?((0,l.uX)(),(0,l.Wv)(R,{key:1},{default:(0,l.k6)(()=>[(0,l.bF)(D,{description:"暂无收藏书籍"})]),_:1})):((0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",c,[a[9]||(a[9]=(0,l.Fv)('<div class="save-book header" data-v-f3519e7e><div class="title" data-v-f3519e7e>书籍名</div><div class="title" data-v-f3519e7e>作者</div><div class="title" data-v-f3519e7e>馆藏数</div><div class="title" data-v-f3519e7e>书籍所在</div><div class="title" data-v-f3519e7e>功能操作</div></div>',1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(F.tableData,(e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:"save-book",key:t},[(0,l.Lk)("div",null,(0,s.v_)(e.bookName),1),(0,l.Lk)("div",null,(0,s.v_)(e.author),1),(0,l.Lk)("div",null,(0,s.v_)(e.num),1),(0,l.Lk)("div",null,(0,s.v_)(F.parseLocation(e)),1),(0,l.Lk)("div",u,[(0,l.Lk)("button",{class:"action-btn borrow",onClick:a=>F.handleEdit(e)},[(0,l.bF)(O,null,{default:(0,l.k6)(()=>[(0,l.bF)($)]),_:1}),a[7]||(a[7]=(0,l.eW)(" 借书 ",-1))],8,v),(0,l.Lk)("button",{class:"action-btn cancel",onClick:a=>F.handleDelete(e)},[(0,l.bF)(O,null,{default:(0,l.k6)(()=>[(0,l.bF)(S)]),_:1}),a[8]||(a[8]=(0,l.eW)(" 取消收藏 ",-1))],8,b)])]))),128))])])),0!==F.tableData.length?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("div",null,[(0,l.bF)(K,{onSizeChange:F.handleSizeChange,onCurrentChange:F.handleCurrentChange,"current-page":F.current,"onUpdate:currentPage":a[2]||(a[2]=e=>F.current=e),"page-size":F.size,layout:"total, prev, pager, next",total:F.totalCount},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])):(0,l.Q3)("",!0),(0,l.bF)(U,{"show-close":!1,modelValue:F.dialogOperation,"onUpdate:modelValue":a[6]||(a[6]=e=>F.dialogOperation=e),width:"400px","custom-class":"borrow-dialog"},{default:(0,l.k6)(()=>[a[15]||(a[15]=(0,l.Lk)("div",{class:"dialog-header"},[(0,l.Lk)("h3",{class:"dialog-title"},"借阅信息")],-1)),(0,l.Lk)("div",k,[(0,l.Lk)("div",h,[(0,l.Lk)("label",p,[(0,l.bF)(O,null,{default:(0,l.k6)(()=>[(0,l.bF)(x)]),_:1}),a[10]||(a[10]=(0,l.eW)(" 借书数量",-1))]),(0,l.bF)(z,{style:{width:"100%"},size:"small",modelValue:F.data.deadlineNum,"onUpdate:modelValue":a[3]||(a[3]=e=>F.data.deadlineNum=e),min:1,max:10,label:"数量","controls-position":"right"},null,8,["modelValue"])]),(0,l.Lk)("div",f,[(0,l.Lk)("label",y,[(0,l.bF)(O,null,{default:(0,l.k6)(()=>[(0,l.bF)(V)]),_:1}),a[11]||(a[11]=(0,l.eW)(" 归还日期",-1))]),(0,l.bF)(I,{style:{width:"100%"},size:"small",modelValue:F.data.returnTime,"onUpdate:modelValue":a[4]||(a[4]=e=>F.data.returnTime=e),type:"date",placeholder:"选择归还日期","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,l.Lk)("div",m,[(0,l.bF)(O,null,{default:(0,l.k6)(()=>[(0,l.bF)(E)]),_:1}),a[12]||(a[12]=(0,l.Lk)("span",null,"请在选定日期前归还图书",-1))])]),(0,l.Lk)("div",C,[(0,l.bF)(j,{class:"cancel-btn",size:"small",onClick:a[5]||(a[5]=e=>F.cannel())},{default:(0,l.k6)(()=>a[13]||(a[13]=[(0,l.eW)("取消操作",-1)])),_:1,__:[13]}),(0,l.bF)(j,{class:"confirm-btn",type:"primary",size:"small",onClick:F.addOperation},{default:(0,l.k6)(()=>a[14]||(a[14]=[(0,l.eW)("确定借书",-1)])),_:1,__:[14]},8,["onClick"])])]),_:1,__:[15]},8,["modelValue"])])}var _=t(953),L=t(8548),w={components:{Search:L.Search,Reading:L.Reading,StarFilled:L.StarFilled,Goods:L.Goods,Calendar:L.Calendar,InfoFilled:L.InfoFilled},setup(){const{proxy:e}=(0,l.nI)(),a=(0,_.Kh)({}),t=(0,_.KR)(1),o=(0,_.KR)(null),s=(0,_.KR)(10),n=(0,_.KR)(0),i=(0,_.KR)(!1),r=(0,_.KR)(!1),d=(0,_.KR)([]),c=(0,_.KR)([]),u=(0,_.Kh)({}),v=(0,_.KR)([]),b=(0,_.KR)([]),g=(0,_.KR)([]),k=(0,_.KR)([]),h=()=>{Object.assign(a,{}),i.value=!1,r.value=!1},p=async()=>{try{if(void 0===a.deadlineNum||void 0===a.returnTime)return void e.$notify({duration:1e3,title:"操作反馈",message:"请填入信息",type:"info"});const t=await e.$axios.post("/bookOrderHistory/save",a);200===t.data.code?(R(),Object.assign(a,{}),i.value=!1,e.$notify({title:"借书结果",message:"借书成功，请及时归还",type:"success"})):e.$notify({title:"借书结果",message:t.data.msg,type:"error"})}catch(t){e.$notify({title:"借书结果",message:t,type:"error"})}},f=e=>e.floor+"-"+e.area+"-"+e.frame,y=e=>e.floor+"-"+e.area+"-"+e.frame,m=()=>{e.$axios.post("bookshelf/query",{}).then(e=>{200===e.data.code&&(b.value=e.data.data)})},C=()=>{e.$axios.post("category/query",{}).then(e=>{200===e.data.code&&(v.value=e.data.data)})},F=()=>{Object.assign(u,{}),R()},L=()=>{e.$axios.post("bookOrderHistory/queryUser",{}).then(e=>{200===e.data.code&&(g.value=e.data.data)})},w=async()=>{try{const t={id:a.id,isReturn:!0},l=await e.$axios.put("/bookSave/update",t);200===l.data.code?(R(),Object.assign(a,{}),i.value=!1,e.$notify({title:"还书结果",message:"还书成功",type:"success"})):e.$notify({title:"还书结果",message:l.data.msg,type:"error"})}catch(t){e.$notify({title:"还书结果",message:t,type:"error"})}},O=()=>{i.value=!1},D=()=>{Object.assign(a,{}),o.value=null},R=async()=>{try{d.value=[];const a={current:t.value,size:s.value,...u},l=await e.$axios.post("/bookSave/queryUser",a),{data:o}=l;d.value=o.data,n.value=o.total}catch(a){console.error("借阅历史信息异常:",a)}},$=()=>{i.value=!0},S=()=>{t.value=1,R()},K=()=>{S()},x=e=>{s.value=e,t.value=1,R()},z=e=>{t.value=e,R()},V=e=>{Object.assign(a,{...e})},I=e=>{i.value=!0,Object.assign(a,{...e})},E=e=>{j(e)},j=async a=>{const t=await e.$swalConfirm({title:"取消收藏？",text:"操作不可回复，是否继续？",icon:"warning"});if(t)try{let t=[a.id];const l=await e.$axios.post("/bookSave/batchDelete",t);200===l.data.code&&(e.$notify({duration:1e3,title:"取消收藏操作",message:"取消收藏成功",type:"success"}),R())}catch(l){e.$notify({duration:3e3,title:"取消收藏操作",message:l,type:"error"}),console.error("取消收藏异常：",l)}};return(0,l.sV)(()=>{R(),C(),m()}),{data:a,current:t,cover:o,size:s,totalCount:n,dialogOperation:i,isOperation:r,tableData:d,selectedRows:c,bookSaveQueryDto:u,options:v,bookshelfOptions:b,bookOrderHistorys:g,searchTime:k,cannel:h,addOperation:p,parseLocation:f,bookshelfConfig:y,fetchBookshelf:m,fetchCategory:C,resetQueryCondition:F,getBookOrderHistory:L,returnOperation:w,closeDialog:O,clearFormData:D,fetchFreshData:R,add:$,handleFilter:S,handleFilterClear:K,handleSizeChange:x,handleCurrentChange:z,messagePush:V,handleEdit:I,handleDelete:E,batchDelete:j}}},O=t(6262);const D=(0,O.A)(w,[["render",F],["__scopeId","data-v-f3519e7e"]]);var R=D}}]);
//# sourceMappingURL=680.82fe5f3e.js.map