"use strict";(self["webpackChunkprosonal_health_web"]=self["webpackChunkprosonal_health_web"]||[]).push([[491],{684:function(e){e.exports=function(e,t){var r="function"==typeof Iterator&&Iterator.prototype[e];if(r)try{r.call({next:null},t).next()}catch(a){return!0}}},1311:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var a=r(641),n=r(3751);const o={class:"operation-log-container"},i={key:0,class:"word-search"},l={class:"item"},s={class:"content-wrapper"},u={key:0,class:"pagination-wrapper"};function c(e,t,r,c,h,d){const p=(0,a.g2)("Search"),f=(0,a.g2)("el-icon"),g=(0,a.g2)("el-empty"),v=(0,a.g2)("el-table-column"),y=(0,a.g2)("Delete"),m=(0,a.g2)("el-button"),b=(0,a.g2)("el-table"),w=(0,a.g2)("el-pagination"),k=(0,a.g2)("el-card");return(0,a.uX)(),(0,a.CE)("div",o,[0!==c.tableData.length?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",l,[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(p)]),_:1}),(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"搜索操作内容","onUpdate:modelValue":t[0]||(t[0]=e=>c.userOperationLogQueryDto.content=e),onKeyup:t[1]||(t[1]=(0,n.jR)((...e)=>c.fetchFreshData&&c.fetchFreshData(...e),["enter"]))},null,544),[[n.Jo,c.userOperationLogQueryDto.content]]),(0,a.Lk)("span",{class:"search-text",onClick:t[2]||(t[2]=(...e)=>c.fetchFreshData&&c.fetchFreshData(...e))},"搜索")])])):(0,a.Q3)("",!0),(0,a.Lk)("div",s,[0===c.tableData.length?((0,a.uX)(),(0,a.Wv)(g,{key:0,description:"暂无操作日志","image-size":200})):((0,a.uX)(),(0,a.Wv)(k,{key:1,class:"log-card"},{default:(0,a.k6)(()=>[t[4]||(t[4]=(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("span",{class:"card-title"},"操作日志记录")],-1)),(0,a.bF)(b,{data:c.tableData,style:{width:"100%"},border:"",stripe:"","highlight-current-row":""},{default:(0,a.k6)(()=>[(0,a.bF)(v,{prop:"content",label:"操作内容","min-width":"300"}),(0,a.bF)(v,{prop:"createTime",label:"操作时间",width:"180"}),(0,a.bF)(v,{label:"操作",width:"120",align:"center"},{default:(0,a.k6)(e=>[(0,a.bF)(m,{type:"danger",size:"small",circle:"",onClick:t=>c.handleDelete(e.row)},{default:(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(y)]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),0!==c.tableData.length?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.bF)(w,{onSizeChange:c.handleSizeChange,onCurrentChange:c.handleCurrentChange,"current-page":c.current,"onUpdate:currentPage":t[3]||(t[3]=e=>c.current=e),"page-size":c.size,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:c.totalCount},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])):(0,a.Q3)("",!0)]),_:1,__:[4]}))])])}r(4114),r(8111),r(2489);var h=r(953),d=r(5220),p=r(8548),f=r(5720),g=r(7309),v={components:{UserNavigation:g.A,Search:p.Search,Delete:p.Delete},setup(){const{proxy:e}=(0,a.nI)(),t=(0,d.rd)(),r=(0,d.lq)(),n=(0,h.KR)({name:"个人中心",path:"/mySelf"}),o=(0,h.KR)([]),i=(0,h.KR)("操作日志"),l=(0,h.Kh)({id:null,url:"",name:"",role:null,email:""}),s=(0,h.KR)(!1),u=(0,h.KR)({}),c=(0,h.KR)(1),p=(0,h.KR)(null),g=(0,h.KR)(10),v=(0,h.KR)(0),y=(0,h.KR)(!1),m=(0,h.KR)(!1),b=(0,h.KR)([]),w=(0,h.KR)([]),k=(0,h.Kh)({current:1,size:10}),C=(0,h.KR)([]),x=(0,h.KR)([]),R=(0,h.KR)([]),D=(0,h.KR)([]),K=()=>{s.value=!s.value,sessionStorage.setItem("flag",s.value)},I=()=>{const a=r;t.replace("/refresh"),e.$nextTick(()=>{t.replace(a.fullPath)})},F=e=>{r.path!==e.path&&t.push(e.path)},S=()=>{s.value="true"===sessionStorage.getItem("flag")},z=async()=>{try{const r=await f.A.get("user/auth");if(400===r.data.code)return e.$message.error(r.data.msg),void t.push("/login");const{id:a,userAvatar:n,userName:o,userRole:i,userEmail:s}=r.data.data;Object.assign(l,{id:a,url:n,name:o,role:i,email:s}),sessionStorage.setItem("userInfo",JSON.stringify(l)),sessionStorage.setItem("userId",l.id)}catch(r){console.error("获取用户认证信息时发生错误:",r),e.$message.error("认证信息加载失败，请重试！")}},_=async()=>{try{const t=await e.$axios.post("/userOperationLog/queryUser",k),{data:r}=t;b.value=r.data,v.value=r.total}catch(t){console.error("系统日志信息异常:",t)}},L=e=>{k.current=1,k.size=e,g.value=e,_()},O=e=>{k.current=e,c.value=e,_()},H=e=>{$(e)},$=async t=>{const r=await e.$swalConfirm({title:"删除操作日志",text:"操作不可恢复，是否继续？",icon:"warning",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消",confirmButtonColor:"#ff5722",cancelButtonColor:"#909399"});if(r)try{let r=[t.id];const a=await e.$axios.post("/userOperationLog/batchDelete",r);200===a.data.code&&(e.$notify({duration:1e3,title:"日志删除",message:"删除成功",type:"success"}),_())}catch(a){e.$notify({title:"日志删除",message:a.message||"删除失败",type:"error"}),console.error("删除异常：",a)}};return(0,a.sV)(()=>{let e=t.options.routes.filter(e=>"/user"==e.path)[0];o.value=e.children,_(),z(),S()}),{selfPath:n,userRoutes:o,nowRoute:i,userInfo:l,flag:s,data:u,current:c,cover:p,size:g,totalCount:v,dialogOperation:y,isOperation:m,tableData:b,selectedRows:w,userOperationLogQueryDto:k,options:C,bookshelfOptions:x,bookOrderHistorys:R,searchTime:D,toggleSidebar:K,refreshPage:I,routerClick:F,menuOperationHistory:S,tokenCheckLoad:z,fetchFreshData:_,handleSizeChange:L,handleCurrentChange:O,handleDelete:H,batchDelete:$}}},y=r(6262);const m=(0,y.A)(v,[["render",c],["__scopeId","data-v-01131363"]]);var b=m},1385:function(e,t,r){var a=r(9539);e.exports=function(e,t,r){for(var n=e.length-1;n>=0;n--)if(void 0!==e[n])try{r=a(e[n].iterator,t,r)}catch(o){t="throw",r=o}if("throw"===t)throw r;return r}},2489:function(e,t,r){var a=r(6518),n=r(9565),o=r(9306),i=r(8551),l=r(1767),s=r(9462),u=r(6319),c=r(6395),h=r(9539),d=r(684),p=r(4549),f=!c&&!d("filter",function(){}),g=!c&&!f&&p("filter",TypeError),v=c||f||g,y=s(function(){var e,t,r,a=this.iterator,o=this.predicate,l=this.next;while(1){if(e=i(n(l,a)),t=this.done=!!e.done,t)return;if(r=e.value,u(a,o,[r,this.counter++],!0))return r}});a({target:"Iterator",proto:!0,real:!0,forced:v},{filter:function(e){i(this);try{o(e)}catch(t){h(this,"throw",t)}return g?n(g,this,e):new y(l(this),{predicate:e})}})},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},6279:function(e,t,r){var a=r(6840);e.exports=function(e,t,r){for(var n in t)a(e,n,t[n],r);return e}},6319:function(e,t,r){var a=r(8551),n=r(9539);e.exports=function(e,t,r,o){try{return o?t(a(r)[0],r[1]):t(r)}catch(i){n(e,"throw",i)}}},9462:function(e,t,r){var a=r(9565),n=r(2360),o=r(6699),i=r(6279),l=r(8227),s=r(1181),u=r(5966),c=r(7657).IteratorPrototype,h=r(2529),d=r(9539),p=r(1385),f=l("toStringTag"),g="IteratorHelper",v="WrapForValidIterator",y="normal",m="throw",b=s.set,w=function(e){var t=s.getterFor(e?v:g);return i(n(c),{next:function(){var r=t(this);if(e)return r.nextHandler();if(r.done)return h(void 0,!0);try{var a=r.nextHandler();return r.returnHandlerResult?a:h(a,r.done)}catch(n){throw r.done=!0,n}},return:function(){var r=t(this),n=r.iterator;if(r.done=!0,e){var o=u(n,"return");return o?a(o,n):h(void 0,!0)}if(r.inner)try{d(r.inner.iterator,y)}catch(i){return d(n,m,i)}if(r.openIters)try{p(r.openIters,y)}catch(i){return d(n,m,i)}return n&&d(n,y),h(void 0,!0)}})},k=w(!0),C=w(!1);o(C,f,"Iterator Helper"),e.exports=function(e,t,r){var a=function(a,n){n?(n.iterator=a.iterator,n.next=a.next):n=a,n.type=t?v:g,n.returnHandlerResult=!!r,n.nextHandler=e,n.counter=0,n.done=!1,b(this,n)};return a.prototype=t?k:C,a}}}]);
//# sourceMappingURL=491.19c6e6ea.js.map