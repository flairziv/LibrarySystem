"use strict";(self["webpackChunkprosonal_health_web"]=self["webpackChunkprosonal_health_web"]||[]).push([[982],{684:function(e){e.exports=function(e,t){var r="function"==typeof Iterator&&Iterator.prototype[e];if(r)try{r.call({next:null},t).next()}catch(n){return!0}}},1385:function(e,t,r){var n=r(9539);e.exports=function(e,t,r){for(var a=e.length-1;a>=0;a--)if(void 0!==e[a])try{r=n(e[a].iterator,t,r)}catch(o){t="throw",r=o}if("throw"===t)throw r;return r}},1701:function(e,t,r){var n=r(6518),a=r(9565),o=r(9306),l=r(8551),i=r(1767),u=r(9462),c=r(6319),s=r(9539),d=r(684),p=r(4549),h=r(6395),f=!h&&!d("map",function(){}),g=!h&&!f&&p("map",TypeError),v=h||f||g,b=u(function(){var e=this.iterator,t=l(a(this.next,e)),r=this.done=!!t.done;if(!r)return c(e,this.mapper,[t.value,this.counter++],!0)});n({target:"Iterator",proto:!0,real:!0,forced:v},{map:function(e){l(this);try{o(e)}catch(t){s(this,"throw",t)}return g?a(g,this,e):new b(i(this),{mapper:e})}})},1982:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var n=r(641),a=r(33);const o={class:"action-buttons"};function l(e,t,r,l,i,u){const c=(0,n.g2)("el-date-picker"),s=(0,n.g2)("el-button"),d=(0,n.g2)("el-row"),p=(0,n.g2)("el-table-column"),h=(0,n.g2)("el-tag"),f=(0,n.g2)("el-table"),g=(0,n.g2)("el-pagination");return(0,n.uX)(),(0,n.Wv)(d,{class:"common-container"},{default:(0,n.k6)(()=>[(0,n.bF)(d,{class:"filter-row"},{default:(0,n.k6)(()=>[t[2]||(t[2]=(0,n.Lk)("span",{class:"top-bar"},"借阅时间",-1)),(0,n.bF)(c,{size:"small",style:{width:"240px"},modelValue:l.searchTime,"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchTime=e),type:"daterange","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"起始日期","end-placeholder":"结束日期"},null,8,["modelValue"]),(0,n.bF)(s,{size:"small",class:"query-btn no-icon",type:"primary",onClick:l.handleFilter},{default:(0,n.k6)(()=>t[1]||(t[1]=[(0,n.eW)("立即查询",-1)])),_:1,__:[1]},8,["onClick"])]),_:1,__:[2]}),(0,n.bF)(d,{class:"table-container"},{default:(0,n.k6)(()=>[(0,n.bF)(f,{data:l.tableData,class:"custom-table"},{default:(0,n.k6)(()=>[(0,n.bF)(p,{prop:"bookName",label:"书籍名"}),(0,n.bF)(p,{prop:"userName",width:"98",label:"订阅者"}),(0,n.bF)(p,{prop:"deadlineNum",width:"88",label:"馆藏数"}),(0,n.bF)(p,{prop:"isReturn",width:"130",label:"是否归还"},{default:(0,n.k6)(e=>[(0,n.bF)(h,{type:e.row.isReturn?"success":"warning",size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,a.v_)(e.row.isReturn?"已归还":"未归还"),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)(p,{prop:"returnTime",width:"168",label:"归还时间"}),(0,n.bF)(p,{prop:"createTime",width:"168",label:"借阅时间"}),(0,n.bF)(p,{label:"操作",width:"100",align:"center"},{default:(0,n.k6)(e=>[(0,n.Lk)("div",o,[(0,n.bF)(h,{type:"danger",size:"small",onClick:t=>l.handleDelete(e.row),class:"action-tag delete-tag"},{default:(0,n.k6)(()=>t[3]||(t[3]=[(0,n.eW)(" 删除 ",-1)])),_:2,__:[3]},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),(0,n.bF)(g,{style:{margin:"20px 0",float:"right"},onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange,"current-page":l.currentPage,"page-sizes":[5,7],"page-size":l.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:l.totalItems},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),_:1})]),_:1})}r(4114),r(8111),r(7588),r(1701);var i=r(953),u={setup(){const{proxy:e}=(0,n.nI)(),t=(0,i.Kh)({}),r=(0,i.KR)(1),a=(0,i.KR)(null),o=(0,i.KR)(7),l=(0,i.KR)(0),u=(0,i.KR)([]),c=(0,i.KR)([]),s=(0,i.Kh)({}),d=(0,i.KR)([]),p=(0,i.KR)([]),h=(0,i.KR)([]),f=e=>{c.value=e},g=async()=>{if(!c.value.length)return void e.$message("未选中任何数据");const t=await e.$swalConfirm({title:"删除借阅记录数据",text:"删除后不可恢复，是否继续？",icon:"warning",showCancelButton:!0,confirmButtonText:"确认删除",cancelButtonText:"取消",confirmButtonColor:"#f56c6c",cancelButtonColor:"#909399",customClass:{popup:"custom-delete-popup",confirmButton:"custom-delete-confirm-button",cancelButton:"custom-delete-cancel-button",title:"custom-delete-title",content:"custom-delete-content",icon:"custom-delete-icon"},buttonsStyling:!0,iconColor:"#f56c6c",backdrop:"rgba(0,0,0,0.4)",heightAuto:!1,padding:"2em"});if(t)try{let t=c.value.map(e=>e.id);const r=await e.$axios.post("bookOrderHistory/batchDelete",t);if(200===r.data.code)return e.$swal.fire({title:"删除成功",text:r.data.msg,icon:"success",showConfirmButton:!1,timer:2e3}),void y()}catch(r){e.$swal.fire({title:"错误提示",text:r,icon:"error",showConfirmButton:!1,timer:2e3}),console.error("借阅历史删除异常：",r)}},v=()=>{h.value=[],Object.keys(s).forEach(e=>{delete s[e]}),y()},b=()=>{dialogOperation.value=!1},m=()=>{Object.keys(t).forEach(e=>{delete t[e]}),a.value=null},y=async()=>{try{u.value=[];let t=null,n=null;null!=h.value&&2===h.value.length&&(t=`${h.value[0]}T00:00:00`,n=`${h.value[1]}T23:59:59`);const a={current:r.value,size:o.value,startTime:t,endTime:n,...s},i=await e.$axios.post("bookOrderHistory/query",a),{data:c}=i;u.value=c.data,l.value=c.total}catch(t){console.error("查询借阅记录信息异常:",t)}},w=()=>{dialogOperation.value=!0},x=()=>{r.value=1,y()},C=()=>{x()},k=e=>{o.value=e,r.value=1,y()},F=e=>{r.value=e,y()},_=e=>{Object.assign(t,{...e})},T=e=>{dialogOperation.value=!0,isOperation.value=!0,Object.assign(t,{...e}),a.value=e.cover},O=e=>{c.value=[],c.value.push(e),g()};return(0,n.sV)(()=>{y()}),{data:t,currentPage:r,cover:a,pageSize:o,totalItems:l,tableData:u,selectedRows:c,bookOrderHistoryQueryDto:s,options:d,bookshelfOptions:p,searchTime:h,handleSelectionChange:f,batchDelete:g,resetQueryCondition:v,closeDialog:b,clearFormData:m,fetchFreshData:y,add:w,handleFilter:x,handleFilterClear:C,handleSizeChange:k,handleCurrentChange:F,messagePush:_,handleEdit:T,handleDelete:O}}},c=r(6262);const s=(0,c.A)(u,[["render",l],["__scopeId","data-v-626a22d0"]]);var d=s},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},4114:function(e,t,r){var n=r(6518),a=r(8981),o=r(6198),l=r(4527),i=r(6837),u=r(9039),c=u(function(){return 4294967297!==[].push.call({length:4294967296},1)}),s=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=c||!s();n({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=a(this),r=o(t),n=arguments.length;i(r+n);for(var u=0;u<n;u++)t[r]=arguments[u],r++;return l(t,r),r}})},4376:function(e,t,r){var n=r(2195);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4527:function(e,t,r){var n=r(3724),a=r(4376),o=TypeError,l=Object.getOwnPropertyDescriptor,i=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=i?function(e,t){if(a(e)&&!l(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6279:function(e,t,r){var n=r(6840);e.exports=function(e,t,r){for(var a in t)n(e,a,t[a],r);return e}},6319:function(e,t,r){var n=r(8551),a=r(9539);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(l){a(e,"throw",l)}}},6837:function(e){var t=TypeError,r=9007199254740991;e.exports=function(e){if(e>r)throw t("Maximum allowed index exceeded");return e}},9462:function(e,t,r){var n=r(9565),a=r(2360),o=r(6699),l=r(6279),i=r(8227),u=r(1181),c=r(5966),s=r(7657).IteratorPrototype,d=r(2529),p=r(9539),h=r(1385),f=i("toStringTag"),g="IteratorHelper",v="WrapForValidIterator",b="normal",m="throw",y=u.set,w=function(e){var t=u.getterFor(e?v:g);return l(a(s),{next:function(){var r=t(this);if(e)return r.nextHandler();if(r.done)return d(void 0,!0);try{var n=r.nextHandler();return r.returnHandlerResult?n:d(n,r.done)}catch(a){throw r.done=!0,a}},return:function(){var r=t(this),a=r.iterator;if(r.done=!0,e){var o=c(a,"return");return o?n(o,a):d(void 0,!0)}if(r.inner)try{p(r.inner.iterator,b)}catch(l){return p(a,m,l)}if(r.openIters)try{h(r.openIters,b)}catch(l){return p(a,m,l)}return a&&p(a,b),d(void 0,!0)}})},x=w(!0),C=w(!1);o(C,f,"Iterator Helper"),e.exports=function(e,t,r){var n=function(n,a){a?(a.iterator=n.iterator,a.next=n.next):a=n,a.type=t?v:g,a.returnHandlerResult=!!r,a.nextHandler=e,a.counter=0,a.done=!1,y(this,a)};return n.prototype=t?x:C,n}}}]);
//# sourceMappingURL=982.f9cf753f.js.map