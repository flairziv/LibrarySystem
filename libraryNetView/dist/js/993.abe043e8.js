"use strict";(self["webpackChunkprosonal_health_web"]=self["webpackChunkprosonal_health_web"]||[]).push([[993],{684:function(e){e.exports=function(e,t){var a="function"==typeof Iterator&&Iterator.prototype[e];if(a)try{a.call({next:null},t).next()}catch(r){return!0}}},1385:function(e,t,a){var r=a(9539);e.exports=function(e,t,a){for(var n=e.length-1;n>=0;n--)if(void 0!==e[n])try{a=r(e[n].iterator,t,a)}catch(o){t="throw",a=o}if("throw"===t)throw a;return a}},1701:function(e,t,a){var r=a(6518),n=a(9565),o=a(9306),l=a(8551),i=a(1767),u=a(9462),c=a(6319),s=a(9539),d=a(684),h=a(4549),p=a(6395),f=!p&&!d("map",function(){}),g=!p&&!f&&h("map",TypeError),m=p||f||g,v=u(function(){var e=this.iterator,t=l(n(this.next,e)),a=this.done=!!t.done;if(!a)return c(e,this.mapper,[t.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(e){l(this);try{o(e)}catch(t){s(this,"throw",t)}return g?n(g,this,e):new v(i(this),{mapper:e})}})},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},5993:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var r=a(641),n=a(33);const o={key:0,class:"operation-bar"};function l(e,t,a,l,i,u){const c=(0,r.g2)("el-date-picker"),s=(0,r.g2)("el-input"),d=(0,r.g2)("Search"),h=(0,r.g2)("el-icon"),p=(0,r.g2)("el-button"),f=(0,r.g2)("el-row"),g=(0,r.g2)("el-table-column"),m=(0,r.g2)("el-tag"),v=(0,r.g2)("el-table"),b=(0,r.g2)("el-pagination");return(0,r.uX)(),(0,r.Wv)(f,{class:"common-container"},{default:(0,r.k6)(()=>[(0,r.bF)(f,{style:{padding:"10px 16px"}},{default:(0,r.k6)(()=>[(0,r.bF)(f,{class:"search-bar-container"},{default:(0,r.k6)(()=>[t[3]||(t[3]=(0,r.Lk)("span",{class:"top-bar"},"日期范围",-1)),(0,r.bF)(c,{size:"small",style:{width:"240px"},onChange:l.fetchFreshData,modelValue:l.searchTime,"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchTime=e),type:"daterange","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"起始日期","end-placeholder":"结束日期"},null,8,["onChange","modelValue"]),(0,r.bF)(s,{size:"small",style:{width:"166px","margin-left":"5px","margin-right":"5px"},modelValue:l.userOperationLogQueryDto.userId,"onUpdate:modelValue":t[1]||(t[1]=e=>l.userOperationLogQueryDto.userId=e),placeholder:"用户ID",clearable:"",onClear:l.handleFilterClear},null,8,["modelValue","onClear"]),(0,r.bF)(p,{size:"small",onClick:l.handleFilter},{default:(0,r.k6)(()=>[(0,r.bF)(h,null,{default:(0,r.k6)(()=>[(0,r.bF)(d)]),_:1})]),_:1},8,["onClick"]),(0,r.bF)(p,{size:"small",class:"customer",style:{"margin-left":"5px","background-color":"#3a8ee6",color:"#ffffff",border:"none","font-weight":"500","box-shadow":"0 2px 6px rgba(58, 142, 230, 0.3)"},onClick:l.resetQueryCondition},{default:(0,r.k6)(()=>t[2]||(t[2]=[(0,r.eW)("重置",-1)])),_:1,__:[2]},8,["onClick"])]),_:1,__:[3]})]),_:1}),(0,r.bF)(f,{style:{margin:"10px 16px"}},{default:(0,r.k6)(()=>[(0,r.bF)(v,{data:l.tableData,class:"custom-table",onSelectionChange:l.handleSelectionChange},{default:(0,r.k6)(()=>[(0,r.bF)(g,{type:"selection",width:"50"}),(0,r.bF)(g,{prop:"content",label:"行为","min-width":"200"}),(0,r.bF)(g,{prop:"userName",width:"130",label:"操作者"}),(0,r.bF)(g,{prop:"createTime",width:"160",label:"发生时间"}),(0,r.bF)(g,{label:"操作",width:"80",align:"center"},{default:(0,r.k6)(e=>[(0,r.bF)(m,{type:"danger",size:"small",onClick:t=>l.handleDelete(e.row),class:"delete-tag"},{default:(0,r.k6)(()=>t[4]||(t[4]=[(0,r.eW)(" 删除 ",-1)])),_:2,__:[4]},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"]),l.selectedRows.length>0?((0,r.uX)(),(0,r.CE)("div",o,[(0,r.bF)(p,{size:"small",type:"danger",onClick:l.batchDelete},{default:(0,r.k6)(()=>[(0,r.eW)("批量删除 ("+(0,n.v_)(l.selectedRows.length)+")",1)]),_:1},8,["onClick"])])):(0,r.Q3)("",!0),(0,r.bF)(b,{style:{margin:"20px 0",float:"right"},onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange,"current-page":l.currentPage,"page-sizes":[20,50],"page-size":l.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:l.totalItems},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),_:1})]),_:1})}a(8111),a(7588),a(1701);var i=a(953),u=a(8548),c={components:{Search:u.Search},setup(){const{proxy:e}=(0,r.nI)(),t=(0,i.KR)({}),a=(0,i.KR)(1),n=(0,i.KR)(null),o=(0,i.KR)(20),l=(0,i.KR)(0),u=(0,i.KR)([]),c=(0,i.KR)([]),s=(0,i.Kh)({}),d=(0,i.KR)([]),h=(0,i.KR)([]),p=(0,i.KR)([]),f=e=>{c.value=e},g=async()=>{if(!c.value.length)return void e.$message("未选中任何数据");const t=await e.$swalConfirm({title:"删除行为日志数据",text:"删除后不可恢复，是否继续？",icon:"warning",showCancelButton:!0,confirmButtonText:"确认删除",cancelButtonText:"取消",confirmButtonColor:"#f56c6c",cancelButtonColor:"#909399",customClass:{popup:"custom-delete-popup",confirmButton:"custom-delete-confirm-button",cancelButton:"custom-delete-cancel-button",title:"custom-delete-title",content:"custom-delete-content",icon:"custom-delete-icon"},buttonsStyling:!0,iconColor:"#f56c6c",backdrop:"rgba(0,0,0,0.4)",heightAuto:!1,padding:"2em"});if(t)try{let t=c.value.map(e=>e.id);const a=await e.$axios.post("userOperationLog/batchDelete",t);if(200===a.data.code)return e.$swal.fire({title:"删除成功",text:a.data.msg,icon:"success",showConfirmButton:!1,timer:2e3}),void C()}catch(a){e.$swal.fire({title:"错误提示",text:a,icon:"error",showConfirmButton:!1,timer:2e3}),console.error("日志信息删除异常：",a)}},m=()=>{p.value=[],Object.keys(s).forEach(e=>delete s[e]),C()},v=()=>{},b=()=>{t.value={},n.value=null},C=async()=>{try{u.value=[];let t=null,r=null;if(null!=p.value&&2===p.value.length){const[e,a]=await Promise.all(p.value.map(e=>e.toISOString()));t=`${e.split("T")[0]}T00:00:00`,r=`${a.split("T")[0]}T23:59:59`}const n={current:a.value,size:o.value,startTime:t,endTime:r,...s},i=await e.$axios.post("userOperationLog/query",n),{data:c}=i;u.value=c.data,l.value=c.total}catch(t){console.error("查询行为日志信息异常:",t)}},y=()=>{},w=()=>{a.value=1,C()},x=()=>{w()},k=e=>{o.value=e,a.value=1,C()},F=e=>{a.value=e,C()},_=e=>{t.value={...e}},z=e=>{t.value={...e},n.value=e.cover},I=e=>{c.value=[e],g()};return(0,r.sV)(()=>{C()}),{data:t,currentPage:a,cover:n,pageSize:o,totalItems:l,tableData:u,selectedRows:c,userOperationLogQueryDto:s,options:d,bookshelfOptions:h,searchTime:p,handleSelectionChange:f,batchDelete:g,resetQueryCondition:m,closeDialog:v,clearFormData:b,fetchFreshData:C,add:y,handleFilter:w,handleFilterClear:x,handleSizeChange:k,handleCurrentChange:F,messagePush:_,handleEdit:z,handleDelete:I}}},s=a(6262);const d=(0,s.A)(c,[["render",l],["__scopeId","data-v-08850d72"]]);var h=d},6279:function(e,t,a){var r=a(6840);e.exports=function(e,t,a){for(var n in t)r(e,n,t[n],a);return e}},6319:function(e,t,a){var r=a(8551),n=a(9539);e.exports=function(e,t,a,o){try{return o?t(r(a)[0],a[1]):t(a)}catch(l){n(e,"throw",l)}}},9462:function(e,t,a){var r=a(9565),n=a(2360),o=a(6699),l=a(6279),i=a(8227),u=a(1181),c=a(5966),s=a(7657).IteratorPrototype,d=a(2529),h=a(9539),p=a(1385),f=i("toStringTag"),g="IteratorHelper",m="WrapForValidIterator",v="normal",b="throw",C=u.set,y=function(e){var t=u.getterFor(e?m:g);return l(n(s),{next:function(){var a=t(this);if(e)return a.nextHandler();if(a.done)return d(void 0,!0);try{var r=a.nextHandler();return a.returnHandlerResult?r:d(r,a.done)}catch(n){throw a.done=!0,n}},return:function(){var a=t(this),n=a.iterator;if(a.done=!0,e){var o=c(n,"return");return o?r(o,n):d(void 0,!0)}if(a.inner)try{h(a.inner.iterator,v)}catch(l){return h(n,b,l)}if(a.openIters)try{p(a.openIters,v)}catch(l){return h(n,b,l)}return n&&h(n,v),d(void 0,!0)}})},w=y(!0),x=y(!1);o(x,f,"Iterator Helper"),e.exports=function(e,t,a){var r=function(r,n){n?(n.iterator=r.iterator,n.next=r.next):n=r,n.type=t?m:g,n.returnHandlerResult=!!a,n.nextHandler=e,n.counter=0,n.done=!1,C(this,n)};return r.prototype=t?w:x,r}}}]);
//# sourceMappingURL=993.abe043e8.js.map