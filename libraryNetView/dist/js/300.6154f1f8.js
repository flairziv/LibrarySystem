"use strict";(self["webpackChunkprosonal_health_web"]=self["webpackChunkprosonal_health_web"]||[]).push([[300],{684:function(e){e.exports=function(e,t){var a="function"==typeof Iterator&&Iterator.prototype[e];if(a)try{a.call({next:null},t).next()}catch(r){return!0}}},1385:function(e,t,a){var r=a(9539);e.exports=function(e,t,a){for(var n=e.length-1;n>=0;n--)if(void 0!==e[n])try{a=r(e[n].iterator,t,a)}catch(o){t="throw",a=o}if("throw"===t)throw a;return a}},1701:function(e,t,a){var r=a(6518),n=a(9565),o=a(9306),l=a(8551),s=a(1767),i=a(9462),c=a(6319),u=a(9539),d=a(684),p=a(4549),h=a(6395),f=!h&&!d("map",function(){}),g=!h&&!f&&p("map",TypeError),v=h||f||g,m=i(function(){var e=this.iterator,t=l(n(this.next,e)),a=this.done=!!t.done;if(!a)return c(e,this.mapper,[t.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:v},{map:function(e){l(this);try{o(e)}catch(t){u(this,"throw",t)}return g?n(g,this,e):new m(s(this),{mapper:e})}})},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},4114:function(e,t,a){var r=a(6518),n=a(8981),o=a(6198),l=a(4527),s=a(6837),i=a(9039),c=i(function(){return 4294967297!==[].push.call({length:4294967296},1)}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=c||!u();r({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=n(this),a=o(t),r=arguments.length;s(a+r);for(var i=0;i<r;i++)t[a]=arguments[i],a++;return l(t,a),a}})},4376:function(e,t,a){var r=a(2195);e.exports=Array.isArray||function(e){return"Array"===r(e)}},4527:function(e,t,a){var r=a(3724),n=a(4376),o=TypeError,l=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(n(e)&&!l(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},5300:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var r=a(641),n=a(33);const o={class:"user-info"},l={class:"username"},s={class:"card-status"},i={class:"card-content"},c={class:"content-text"},u={key:0,class:"card-reply"},d={class:"reply-icon"},p={class:"reply-text"},h={class:"card-footer"},f={class:"time-info"},g={class:"time-item"},v={class:"content-section"},m={class:"card-actions"},y={class:"dialog-header"},C={class:"dialog-title-wrapper"},b={class:"dialog-content"},k={class:"original-content"},_={class:"content-text"},w={class:"reply-area"},x={class:"char-counter"},F={class:"dialog-footer"};function L(e,t,a,L,P,D){const z=(0,r.g2)("el-input"),R=(0,r.g2)("el-button"),T=(0,r.g2)("el-row"),I=(0,r.g2)("el-empty"),W=(0,r.g2)("el-avatar"),O=(0,r.g2)("Comment"),V=(0,r.g2)("el-icon"),B=(0,r.g2)("Timer"),E=(0,r.g2)("ChatDotRound"),H=(0,r.g2)("ChatLineRound"),K=(0,r.g2)("Delete"),$=(0,r.g2)("el-col"),S=(0,r.g2)("el-pagination"),A=(0,r.g2)("Close"),Q=(0,r.g2)("el-dialog");return(0,r.uX)(),(0,r.Wv)(T,{class:"proposal-container"},{default:(0,r.k6)(()=>[(0,r.bF)(T,{class:"search-area"},{default:(0,r.k6)(()=>[(0,r.bF)(T,null,{default:(0,r.k6)(()=>[t[6]||(t[6]=(0,r.Lk)("span",{class:"top-bar"},"反馈",-1)),(0,r.bF)(z,{size:"small",style:{width:"188px","margin-right":"10px"},modelValue:L.readingProposalQueryDto.content,"onUpdate:modelValue":t[0]||(t[0]=e=>L.readingProposalQueryDto.content=e),placeholder:"问题",clearable:"",onClear:L.handleFilterClear},null,8,["modelValue","onClear"]),(0,r.bF)(R,{type:"primary",size:"small",onClick:L.handleFilter,class:"no-icon",style:{"padding-left":"15px","padding-right":"15px"}},{default:(0,r.k6)(()=>t[5]||(t[5]=[(0,r.eW)("立即查询",-1)])),_:1,__:[5]},8,["onClick"])]),_:1,__:[6]})]),_:1}),(0,r.bF)(T,{class:"cards-container"},{default:(0,r.k6)(()=>[0===L.tableData.length?((0,r.uX)(),(0,r.Wv)(I,{key:0,description:"暂无反馈数据"})):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(L.tableData,(e,a)=>((0,r.uX)(),(0,r.Wv)($,{xs:24,sm:24,md:24,lg:12,xl:8,key:a,class:"card-col"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",{class:(0,n.C4)(["feedback-card",L.getCardColorClass(a)])},[(0,r.Lk)("div",{class:(0,n.C4)(["card-header",L.getHeaderColorClass(a)])},[(0,r.Lk)("div",o,[(0,r.bF)(W,{size:32,src:e.userAvatar,class:"avatar"},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(e.userName?e.userName.substring(0,1):"U"),1)]),_:2},1032,["src"]),(0,r.Lk)("span",l,(0,n.v_)(e.userName),1)]),(0,r.Lk)("div",s,[(0,r.Lk)("span",{class:(0,n.C4)(["status-tag",e.isPublish?"public-tag":"private-tag"])},(0,n.v_)(e.isPublish?"公开":"隐私"),3)])],2),(0,r.Lk)("div",i,[t[7]||(t[7]=(0,r.Lk)("h4",{class:"section-title"},"反馈内容",-1)),(0,r.Lk)("div",c,(0,n.v_)(e.content),1)]),e.replyContent?((0,r.uX)(),(0,r.CE)("div",u,[t[8]||(t[8]=(0,r.Lk)("h4",{class:"section-title"},"回复内容",-1)),(0,r.Lk)("div",{class:(0,n.C4)(["reply-container",L.getReplyColorClass(a)])},[(0,r.Lk)("div",d,[(0,r.bF)(V,null,{default:(0,r.k6)(()=>[(0,r.bF)(O)]),_:1})]),(0,r.Lk)("div",p,(0,n.v_)(e.replyContent),1)],2)])):(0,r.Q3)("",!0),(0,r.Lk)("div",h,[(0,r.Lk)("div",f,[(0,r.Lk)("div",g,[(0,r.bF)(V,null,{default:(0,r.k6)(()=>[(0,r.bF)(B)]),_:1}),(0,r.eW)(" "+(0,n.v_)(e.createTime),1)]),(0,r.Lk)("div",v,[(0,r.bF)(V,null,{default:(0,r.k6)(()=>[(0,r.bF)(E)]),_:1}),(0,r.eW)(" "+(0,n.v_)(e.content),1)])]),(0,r.Lk)("div",m,[null===e.replyTime?((0,r.uX)(),(0,r.Wv)(R,{key:0,size:"small",type:"success",plain:"",class:"action-btn",onClick:t=>L.handleEdit(e)},{default:(0,r.k6)(()=>[(0,r.bF)(V,null,{default:(0,r.k6)(()=>[(0,r.bF)(H)]),_:1}),t[9]||(t[9]=(0,r.eW)("回复 ",-1))]),_:2,__:[9]},1032,["onClick"])):(0,r.Q3)("",!0),(0,r.bF)(R,{size:"small",type:"danger",plain:"",class:"action-btn",onClick:t=>L.handleDelete(e)},{default:(0,r.k6)(()=>[(0,r.bF)(V,null,{default:(0,r.k6)(()=>[(0,r.bF)(K)]),_:1}),t[10]||(t[10]=(0,r.eW)("删除 ",-1))]),_:2,__:[10]},1032,["onClick"])])])],2)]),_:2},1024))),128))]),_:1}),(0,r.bF)(S,{class:"pagination",onSizeChange:L.handleSizeChange,onCurrentChange:L.handleCurrentChange,"current-page":L.currentPage,"page-sizes":[4,8],"page-size":L.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:L.totalItems},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"]),(0,r.bF)(Q,{modelValue:L.dialogOperation,"onUpdate:modelValue":t[4]||(t[4]=e=>L.dialogOperation=e),width:"460px","custom-class":"reply-dialog","show-close":!1},{default:(0,r.k6)(()=>[(0,r.Lk)("div",y,[(0,r.Lk)("div",C,[(0,r.bF)(V,{class:"dialog-icon"},{default:(0,r.k6)(()=>[(0,r.bF)(O)]),_:1}),t[11]||(t[11]=(0,r.Lk)("span",{class:"dialog-title"},"回复反馈",-1))]),(0,r.bF)(V,{class:"close-btn",onClick:t[1]||(t[1]=e=>L.dialogOperation=!1)},{default:(0,r.k6)(()=>[(0,r.bF)(A)]),_:1})]),(0,r.Lk)("div",b,[(0,r.Lk)("div",k,[t[12]||(t[12]=(0,r.Lk)("div",{class:"content-label"},"原反馈内容：",-1)),(0,r.Lk)("div",_,(0,n.v_)(L.data.content),1)]),(0,r.Lk)("div",w,[t[13]||(t[13]=(0,r.Lk)("div",{class:"content-label"},"回复内容",-1)),(0,r.bF)(z,{type:"textarea",rows:4,placeholder:"请输入回复内容...",modelValue:L.data.replyContent,"onUpdate:modelValue":t[2]||(t[2]=e=>L.data.replyContent=e)},null,8,["modelValue"]),(0,r.Lk)("div",x,(0,n.v_)(L.data.replyContent?L.data.replyContent.length:0)+"/500",1)])]),(0,r.Lk)("div",F,[(0,r.bF)(R,{class:"cancel-btn",size:"small",onClick:t[3]||(t[3]=e=>L.dialogOperation=!1)},{default:(0,r.k6)(()=>t[14]||(t[14]=[(0,r.eW)("取 消",-1)])),_:1,__:[14]}),(0,r.bF)(R,{class:"confirm-btn",type:"primary",size:"small",onClick:L.updateOperation},{default:(0,r.k6)(()=>t[15]||(t[15]=[(0,r.eW)("确 定",-1)])),_:1,__:[15]},8,["onClick"])])]),_:1},8,["modelValue"])]),_:1})}a(4114),a(8111),a(7588),a(1701);var P=a(953),D=a(8548),z={components:{Comment:D.Comment,Timer:D.Timer,ChatDotRound:D.ChatDotRound,ChatLineRound:D.ChatLineRound,Delete:D.Delete,Close:D.Close},setup(){const{proxy:e}=(0,r.nI)(),t=(0,P.KR)({}),a=(0,P.KR)(1),n=(0,P.KR)(7),o=(0,P.KR)(0),l=(0,P.KR)(!1),s=(0,P.KR)([]),i=(0,P.KR)([]),c=(0,P.Kh)({}),u=e=>{const t=["card-red","card-yellow","card-green","card-blue"];return t[e%4]},d=e=>{const t=["header-red","header-yellow","header-green","header-blue"];return t[e%4]},p=e=>{const t=["reply-red","reply-yellow","reply-green","reply-blue"];return t[e%4]},h=async()=>{if(!i.value.length)return void e.$message("未选中任何数据");const t=await e.$swalConfirm({title:"删除反馈数据",text:"删除后不可恢复，是否继续？",icon:"warning",showCancelButton:!0,confirmButtonText:"确认删除",cancelButtonText:"取消",confirmButtonColor:"#f56c6c",cancelButtonColor:"#909399",customClass:{popup:"custom-delete-popup",confirmButton:"custom-delete-confirm-button",cancelButton:"custom-delete-cancel-button",title:"custom-delete-title",content:"custom-delete-content",icon:"custom-delete-icon"},buttonsStyling:!0,iconColor:"#f56c6c",backdrop:"rgba(0,0,0,0.4)",heightAuto:!1,padding:"2em"});if(t)try{let t=i.value.map(e=>e.id);const a=await e.$axios.post("/readerProposal/batchDelete",t);if(200===a.data.code)return e.$swal.fire({title:"删除成功",text:a.data.msg,icon:"success",showConfirmButton:!1,timer:2e3}),void m()}catch(a){e.$swal.fire({title:"错误提示",text:a,icon:"error",showConfirmButton:!1,timer:2e3}),console.error("反馈信息删除异常：",a)}},f=async()=>{try{const a=await e.$axios.put("/readerProposal/update",t.value);e.$swal.fire({title:"回复成功",text:a.data.msg,icon:200===a.data.code?"success":"error",showConfirmButton:!1,timer:1e3}),200===a.data.code&&(g(),m(),v())}catch(a){console.error("提交表单时出错:",a),e.$message.error("提交失败，请稍后再试！")}},g=()=>{l.value=!1},v=()=>{t.value={}},m=async()=>{try{s.value=[];let t=null,r=null;const l={current:a.value,size:n.value,startTime:t,endTime:r,...c},i=await e.$axios.post("/readerProposal/query",l),{data:u}=i;console.log("返回的反馈数据:",u.data),u.data&&u.data.length>0&&(console.log("第一条数据的isPublish值:",u.data[0].isPublish),console.log("第一条数据的完整内容:",u.data[0]),u.data.forEach(e=>{"boolean"!==typeof e.isPublish&&("true"===e.isPublish||1===e.isPublish||"1"===e.isPublish?e.isPublish=!0:e.isPublish=!1)})),s.value=u.data,o.value=u.total}catch(t){console.error("查询反馈信息异常:",t)}},y=()=>{a.value=1,m()},C=()=>{y()},b=e=>{n.value=e,a.value=1,m()},k=e=>{a.value=e,m()},_=e=>{l.value=!0,e.userPwd=null,t.value={...e}},w=e=>{i.value.push(e),h()};return(0,r.sV)(()=>{m()}),{data:t,currentPage:a,pageSize:n,totalItems:o,dialogOperation:l,tableData:s,selectedRows:i,readingProposalQueryDto:c,getCardColorClass:u,getHeaderColorClass:d,getReplyColorClass:p,batchDelete:h,updateOperation:f,closeDialog:g,clearFormData:v,fetchFreshData:m,handleFilter:y,handleFilterClear:C,handleSizeChange:b,handleCurrentChange:k,handleEdit:_,handleDelete:w}}},R=a(6262);const T=(0,R.A)(z,[["render",L],["__scopeId","data-v-524da4e8"]]);var I=T},6279:function(e,t,a){var r=a(6840);e.exports=function(e,t,a){for(var n in t)r(e,n,t[n],a);return e}},6319:function(e,t,a){var r=a(8551),n=a(9539);e.exports=function(e,t,a,o){try{return o?t(r(a)[0],a[1]):t(a)}catch(l){n(e,"throw",l)}}},6837:function(e){var t=TypeError,a=9007199254740991;e.exports=function(e){if(e>a)throw t("Maximum allowed index exceeded");return e}},9462:function(e,t,a){var r=a(9565),n=a(2360),o=a(6699),l=a(6279),s=a(8227),i=a(1181),c=a(5966),u=a(7657).IteratorPrototype,d=a(2529),p=a(9539),h=a(1385),f=s("toStringTag"),g="IteratorHelper",v="WrapForValidIterator",m="normal",y="throw",C=i.set,b=function(e){var t=i.getterFor(e?v:g);return l(n(u),{next:function(){var a=t(this);if(e)return a.nextHandler();if(a.done)return d(void 0,!0);try{var r=a.nextHandler();return a.returnHandlerResult?r:d(r,a.done)}catch(n){throw a.done=!0,n}},return:function(){var a=t(this),n=a.iterator;if(a.done=!0,e){var o=c(n,"return");return o?r(o,n):d(void 0,!0)}if(a.inner)try{p(a.inner.iterator,m)}catch(l){return p(n,y,l)}if(a.openIters)try{h(a.openIters,m)}catch(l){return p(n,y,l)}return n&&p(n,m),d(void 0,!0)}})},k=b(!0),_=b(!1);o(_,f,"Iterator Helper"),e.exports=function(e,t,a){var r=function(r,n){n?(n.iterator=r.iterator,n.next=r.next):n=r,n.type=t?v:g,n.returnHandlerResult=!!a,n.nextHandler=e,n.counter=0,n.done=!1,C(this,n)};return r.prototype=t?k:_,r}}}]);
//# sourceMappingURL=300.6154f1f8.js.map