"use strict";(self["webpackChunkprosonal_health_web"]=self["webpackChunkprosonal_health_web"]||[]).push([[964],{1964:function(e,a,t){t.r(a),t.d(a,{default:function(){return C}});var o=t(641),s=t(3751),r=t(33);const n={class:"book-rss-history-container"},l={key:0,class:"word-search"},i={class:"item"},c={key:2,class:"book-rss-container"},d={class:"book-rss-table"},u={class:"action-buttons"},v=["onClick"],h={key:3,class:"pager"};function y(e,a,t,y,p,g){const k=(0,o.g2)("Search"),b=(0,o.g2)("el-icon"),f=(0,o.g2)("el-empty"),C=(0,o.g2)("el-row"),m=(0,o.g2)("el-pagination");return(0,o.uX)(),(0,o.CE)("div",n,[0!==y.tableData.length?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",i,[(0,o.bF)(b,null,{default:(0,o.k6)(()=>[(0,o.bF)(k)]),_:1}),(0,o.bo)((0,o.Lk)("input",{type:"text",placeholder:"书籍ID","onUpdate:modelValue":a[0]||(a[0]=e=>y.bookRssHistoryQueryDto.bookId=e)},null,512),[[s.Jo,y.bookRssHistoryQueryDto.bookId]]),(0,o.Lk)("span",{class:"search-text",onClick:a[1]||(a[1]=(...e)=>y.fetchFreshData&&y.fetchFreshData(...e))},"搜索")])])):(0,o.Q3)("",!0),0===y.tableData.length?((0,o.uX)(),(0,o.Wv)(C,{key:1},{default:(0,o.k6)(()=>[(0,o.bF)(f,{description:"暂无订阅书籍"})]),_:1})):((0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("div",d,[a[3]||(a[3]=(0,o.Fv)('<div class="save-book header" data-v-1287d018><div class="title" data-v-1287d018>书籍名</div><div class="title" data-v-1287d018>作者</div><div class="title" data-v-1287d018>馆藏数</div><div class="title" data-v-1287d018>书籍所在</div><div class="title" data-v-1287d018>功能操作</div></div>',1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(y.tableData,(e,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"save-book",key:a},[(0,o.Lk)("div",null,(0,r.v_)(e.bookName),1),(0,o.Lk)("div",null,(0,r.v_)(e.author),1),(0,o.Lk)("div",null,(0,r.v_)(e.num),1),(0,o.Lk)("div",null,(0,r.v_)(y.parseLocation(e)),1),(0,o.Lk)("div",u,[(0,o.Lk)("span",{class:"action-btn cancel",onClick:a=>y.handleDelete(e)},"取消订阅",8,v)])]))),128))])])),0!==y.tableData.length?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",null,[(0,o.bF)(m,{onSizeChange:y.handleSizeChange,onCurrentChange:y.handleCurrentChange,"current-page":y.current,"onUpdate:currentPage":a[2]||(a[2]=e=>y.current=e),"page-size":y.size,layout:"total, prev, pager, next",total:y.totalCount},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])):(0,o.Q3)("",!0)])}var p=t(953),g=t(8548),k={components:{Search:g.Search},setup(){const{proxy:e}=(0,o.nI)(),a=(0,p.Kh)({}),t=(0,p.KR)(1),s=(0,p.KR)(null),r=(0,p.KR)(10),n=(0,p.KR)(0),l=(0,p.KR)(!1),i=(0,p.KR)(!1),c=(0,p.KR)([]),d=(0,p.KR)([]),u=(0,p.Kh)({}),v=(0,p.KR)([]),h=(0,p.KR)([]),y=(0,p.KR)([]),g=(0,p.KR)([]),k=()=>{Object.assign(a,{}),l.value=!1,i.value=!1},b=async()=>{try{a.bookId=a.bookId;const t=await e.$axios.post("/bookOrderHistory/save",a);200===t.data.code?(L(),Object.assign(a,{}),l.value=!1,e.$notify({title:"借书结果",message:"借书成功，请及时归还",type:"success"})):e.$notify({title:"借书结果",message:t.data.msg,type:"error"})}catch(t){e.$notify({title:"借书结果",message:t,type:"error"})}},f=e=>e.floor+"-"+e.area+"-"+e.frame,C=e=>e.floor+"-"+e.area+"-"+e.frame,m=()=>{e.$axios.post("bookshelf/query",{}).then(e=>{200===e.data.code&&(h.value=e.data.data)})},R=()=>{e.$axios.post("category/query",{}).then(e=>{200===e.data.code&&(v.value=e.data.data)})},D=()=>{Object.assign(u,{}),L()},O=()=>{e.$axios.post("bookOrderHistory/queryUser",{}).then(e=>{200===e.data.code&&(y.value=e.data.data)})},$=async()=>{try{const t={id:a.id,isReturn:!0},o=await e.$axios.put("bookRssHistory/update",t);200===o.data.code?(L(),Object.assign(a,{}),l.value=!1,e.$notify({title:"还书结果",message:"还书成功",type:"success"})):e.$notify({title:"还书结果",message:o.data.msg,type:"error"})}catch(t){e.$notify({title:"还书结果",message:t,type:"error"})}},K=()=>{l.value=!1},w=()=>{Object.assign(a,{}),s.value=null},L=async()=>{try{c.value=[];const a={current:t.value,size:r.value,...u},o=await e.$axios.post("bookRssHistory/queryUser",a),{data:s}=o;c.value=s.data,n.value=s.total}catch(a){console.error("借阅历史信息异常:",a)}},x=()=>{l.value=!0},F=()=>{t.value=1,L()},_=()=>{F()},H=e=>{r.value=e,t.value=1,L()},z=e=>{t.value=e,L()},I=e=>{Object.assign(a,{...e})},j=e=>{l.value=!0,Object.assign(a,{...e})},E=e=>{S(e)},S=async a=>{const t=await e.$swalConfirm({title:"取消订阅？",text:"操作不可回复，是否继续？",icon:"warning"});if(t)try{let t=[a.id];const o=await e.$axios.post("bookRssHistory/batchDelete",t);200===o.data.code&&(e.$notify({duration:1e3,title:"取消订阅操作",message:"取消订阅成功",type:"success"}),L())}catch(o){e.$notify({duration:3e3,title:"取消订阅操作",message:o,type:"error"}),console.error("取消订阅异常：",o)}};return(0,o.sV)(()=>{L(),R(),m()}),{data:a,current:t,cover:s,size:r,totalCount:n,dialogOperation:l,isOperation:i,tableData:c,selectedRows:d,bookRssHistoryQueryDto:u,options:v,bookshelfOptions:h,bookOrderHistorys:y,searchTime:g,cannel:k,addOperation:b,parseLocation:f,bookshelfConfig:C,fetchBookshelf:m,fetchCategory:R,resetQueryCondition:D,getBookOrderHistory:O,returnOperation:$,closeDialog:K,clearFormData:w,fetchFreshData:L,add:x,handleFilter:F,handleFilterClear:_,handleSizeChange:H,handleCurrentChange:z,messagePush:I,handleEdit:j,handleDelete:E,batchDelete:S}}},b=t(6262);const f=(0,b.A)(k,[["render",y],["__scopeId","data-v-1287d018"]]);var C=f}}]);
//# sourceMappingURL=964.dbc88a92.js.map