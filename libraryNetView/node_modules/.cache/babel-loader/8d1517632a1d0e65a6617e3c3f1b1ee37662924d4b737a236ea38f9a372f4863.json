{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, reactive, onMounted, getCurrentInstance } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { Search, View } from '@element-plus/icons-vue';\nexport default {\n  components: {\n    Search,\n    View\n  },\n  setup() {\n    const {\n      proxy\n    } = getCurrentInstance();\n    const router = useRouter();\n\n    // 响应式数据\n    const current = ref(1); // 当前页\n    const size = ref(10); // 页面大小\n    const totalCount = ref(0); // 总数据\n    const noticeList = ref([]); // 数据项\n    const noticeQueryDto = reactive({}); // 公告搜索条件\n    const routeNoticeDetail = ref('/noticeDetail');\n    const jsonNoticeInfoName = ref('noticeInfo');\n    const previewMaxLength = ref(120); // 预览内容最大长度\n\n    // 方法\n    // 公告阅读\n    const seeContent = notice => {\n      sessionStorage.setItem(jsonNoticeInfoName.value, JSON.stringify(notice));\n      router.push(routeNoticeDetail.value);\n    };\n\n    // 查询公告数据\n    const fetchNoticeList = async () => {\n      try {\n        const response = await proxy.$axios.post('/notice/query', noticeQueryDto);\n        const {\n          data\n        } = response;\n        if (data.code === 200) {\n          noticeList.value = data.data;\n          totalCount.value = data.total;\n        }\n      } catch (error) {\n        proxy.$notify({\n          title: '公告查询异常',\n          message: error,\n          type: 'error'\n        });\n        console.error('系统公告信息异常:', error);\n      }\n    };\n\n    // 获取内容预览\n    const getContentPreview = htmlContent => {\n      if (!htmlContent) return '';\n\n      // 创建临时元素提取纯文本\n      const tempDiv = document.createElement('div');\n      tempDiv.innerHTML = htmlContent;\n      let plainText = tempDiv.textContent || tempDiv.innerText || '';\n\n      // 移除多余空白\n      plainText = plainText.replace(/\\s+/g, ' ').trim();\n\n      // 限制长度并添加省略号\n      if (plainText.length > previewMaxLength.value) {\n        return plainText.substring(0, previewMaxLength.value) + '...';\n      }\n      return plainText;\n    };\n\n    // 分页页数大小切换\n    const handleSizeChange = sizeValue => {\n      noticeQueryDto.size = sizeValue;\n      noticeQueryDto.current = 1;\n      fetchNoticeList();\n    };\n\n    // 分页页数切换\n    const handleCurrentChange = currentValue => {\n      noticeQueryDto.size = 10;\n      noticeQueryDto.current = currentValue;\n      fetchNoticeList();\n    };\n\n    // 生命周期\n    onMounted(() => {\n      fetchNoticeList();\n    });\n    return {\n      current,\n      size,\n      totalCount,\n      noticeList,\n      noticeQueryDto,\n      routeNoticeDetail,\n      jsonNoticeInfoName,\n      previewMaxLength,\n      seeContent,\n      fetchNoticeList,\n      getContentPreview,\n      handleSizeChange,\n      handleCurrentChange\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","getCurrentInstance","useRouter","Search","View","components","setup","proxy","router","current","size","totalCount","noticeList","noticeQueryDto","routeNoticeDetail","jsonNoticeInfoName","previewMaxLength","seeContent","notice","sessionStorage","setItem","value","JSON","stringify","push","fetchNoticeList","response","$axios","post","data","code","total","error","$notify","title","message","type","console","getContentPreview","htmlContent","tempDiv","document","createElement","innerHTML","plainText","textContent","innerText","replace","trim","length","substring","handleSizeChange","sizeValue","handleCurrentChange","currentValue"],"sources":["E:\\code\\IntelliJ_IDEAProjects\\LibrarySystem\\libraryNetView\\src\\views\\user\\Notice.vue"],"sourcesContent":["<template>\n    <div class=\"notice-container\">\n        <!-- 条件搜索 -->\n        <div class=\"word-search\" v-if=\"noticeList.length !== 0\">\n            <div class=\"item\">\n                    <el-icon><Search /></el-icon>\n                    <input type=\"text\" placeholder=\"搜索公告标题\" v-model=\"noticeQueryDto.name\" @keyup.enter=\"fetchNoticeList\">\n                    <span class=\"search-text\" @click=\"fetchNoticeList\">搜索</span>\n            </div>\n        </div>\n\n        <!-- 内容区 -->\n        <div class=\"content-wrapper\">\n            <el-empty \n                v-if=\"noticeList.length === 0\" \n                description=\"暂无公告\" \n                :image-size=\"200\">\n            </el-empty>\n            \n            <div v-else class=\"notice-list\">\n                <div class=\"page-title\">\n                    <span class=\"title-text\">系统公告</span>\n                    <div class=\"line-decoration\"></div>\n                </div>\n                \n                <div \n                    v-for=\"(notice, index) in noticeList\" \n                    :key=\"index\"\n                    class=\"notice-card\">\n                    <div class=\"time-marker\"></div>\n                    <div class=\"notice-content\">\n                        <div class=\"notice-date\">{{ notice.createTime }}</div>\n                            <h3 class=\"notice-title\">{{ notice.name }}</h3>\n                        <div class=\"notice-summary\">\n                            <div v-if=\"notice.content\" class=\"preview-content\" v-html=\"getContentPreview(notice.content)\"></div>\n                            <div v-else class=\"preview-placeholder\">暂无内容预览，点击查看详情...</div>\n                        </div>\n                        <div class=\"btn-container\">\n                            <el-button \n                                type=\"warning\" \n                                size=\"small\" \n                                circle\n                                @click=\"seeContent(notice)\"\n                                class=\"detail-btn\">\n                                <el-icon><View /></el-icon>\n                            </el-button>\n                            <span class=\"btn-text\">查看详情</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- 分页区 -->\n        <div class=\"pagination-wrapper\" v-if=\"noticeList.length !== 0\">\n            <el-pagination\n                @size-change=\"handleSizeChange\"\n                @current-change=\"handleCurrentChange\"\n                v-model:current-page=\"current\"\n                :page-size=\"size\"\n                :page-sizes=\"[10, 20, 50, 100]\"\n                layout=\"total, sizes, prev, pager, next, jumper\"\n                :total=\"totalCount\">\n            </el-pagination>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { ref, reactive, onMounted, getCurrentInstance } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Search, View } from '@element-plus/icons-vue'\n\nexport default {\n    components: {\n        Search,\n        View\n    },\n    setup() {\n        const { proxy } = getCurrentInstance()\n        const router = useRouter()\n        \n        // 响应式数据\n        const current = ref(1) // 当前页\n        const size = ref(10) // 页面大小\n        const totalCount = ref(0) // 总数据\n        const noticeList = ref([]) // 数据项\n        const noticeQueryDto = reactive({}) // 公告搜索条件\n        const routeNoticeDetail = ref('/noticeDetail')\n        const jsonNoticeInfoName = ref('noticeInfo')\n        const previewMaxLength = ref(120) // 预览内容最大长度\n\n        // 方法\n        // 公告阅读\n        const seeContent = (notice) => {\n            sessionStorage.setItem(jsonNoticeInfoName.value, JSON.stringify(notice));\n            router.push(routeNoticeDetail.value);\n        }\n\n        // 查询公告数据\n        const fetchNoticeList = async () => {\n            try {\n                const response = await proxy.$axios.post('/notice/query', noticeQueryDto);\n                const { data } = response;\n                if (data.code === 200) {\n                    noticeList.value = data.data;\n                    totalCount.value = data.total;\n                }\n            } catch (error) {\n                proxy.$notify({\n                    title: '公告查询异常',\n                    message: error,\n                    type: 'error'\n                });\n                console.error('系统公告信息异常:', error);\n            }\n        }\n\n        // 获取内容预览\n        const getContentPreview = (htmlContent) => {\n            if (!htmlContent) return '';\n            \n            // 创建临时元素提取纯文本\n            const tempDiv = document.createElement('div');\n            tempDiv.innerHTML = htmlContent;\n            let plainText = tempDiv.textContent || tempDiv.innerText || '';\n            \n            // 移除多余空白\n            plainText = plainText.replace(/\\s+/g, ' ').trim();\n            \n            // 限制长度并添加省略号\n            if (plainText.length > previewMaxLength.value) {\n                return plainText.substring(0, previewMaxLength.value) + '...';\n            }\n            \n            return plainText;\n        }\n\n        // 分页页数大小切换\n        const handleSizeChange = (sizeValue) => {\n            noticeQueryDto.size = sizeValue;\n            noticeQueryDto.current = 1;\n            fetchNoticeList();\n        }\n\n        // 分页页数切换\n        const handleCurrentChange = (currentValue) => {\n            noticeQueryDto.size = 10;\n            noticeQueryDto.current = currentValue;\n            fetchNoticeList();\n        }\n\n        // 生命周期\n        onMounted(() => {\n            fetchNoticeList();\n        })\n\n        return {\n            current,\n            size,\n            totalCount,\n            noticeList,\n            noticeQueryDto,\n            routeNoticeDetail,\n            jsonNoticeInfoName,\n            previewMaxLength,\n            seeContent,\n            fetchNoticeList,\n            getContentPreview,\n            handleSizeChange,\n            handleCurrentChange\n        }\n    }\n};\n</script>\n\n<style scoped lang=\"scss\">\n.notice-container {\n    padding: 10px;\n    border-radius: 16px;\n    background-color: transparent;\n    backdrop-filter: none;\n    box-shadow: none;\n}\n\n.word-search {\n    display: flex;\n    justify-content: center;\n    margin-bottom: 20px;\n        \n    .item {\n        padding: 10px 20px;\n        width: 500px;\n        background-color: rgba(255, 255, 255, 0.8);\n        backdrop-filter: blur(10px);\n        border-radius: 40px;\n            display: flex;\n        justify-content: space-between;\n                align-items: center;\n                box-sizing: border-box;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.06);\n        border: 1px solid rgba(255, 255, 255, 0.3);\n                transition: all 0.3s ease;\n                \n                &:hover, &:focus-within {\n                    box-shadow: 0 6px 16px rgba(255, 87, 34, 0.12);\n                    border-color: rgba(255, 87, 34, 0.2);\n                }\n                \n                input {\n                    flex: 1;\n                    border: none;\n                    background-color: transparent;\n                    outline: none;\n                    font-size: 16px;\n                    color: #333;\n                    margin: 0 15px;\n                    height: 24px;\n                }\n\n        i {\n            font-size: 18px;\n            color: #ff5722;\n        }\n                \n                .search-text {\n                    display: inline-block;\n                    padding: 6px 16px;\n                    border-radius: 20px;\n                    background-color: #ff5722;\n                    color: white;\n                    font-size: 14px;\n                    cursor: pointer;\n                    transition: all 0.3s ease;\n                    text-align: center;\n                    \n                    &:hover {\n                        background-color: #f4511e;\n                        transform: translateY(-1px);\n                }\n            }\n        }\n    }\n    \n    .content-wrapper {\n        background-color: transparent;\n        min-height: 500px;\n        display: flex;\n        justify-content: center;\n        align-items: flex-start;\n        \n        .notice-list {\n            width: 100%;\n            max-width: 900px;\n            margin: 0 auto;\n            position: relative;\n            \n            /* 时间轴垂直线 */\n            &::before {\n                content: '';\n                position: absolute;\n                top: 0;\n                bottom: 0;\n                left: 20px;\n                width: 2px;\n                background: linear-gradient(to bottom, #FFB74D, #FFCC80);\n                z-index: 0;\n            }\n            \n            .page-title {\n                margin-bottom: 24px;\n                position: relative;\n                display: flex;\n                align-items: center;\n                padding-left: 50px;\n                \n                .title-text {\n                    font-size: 20px;\n                    font-weight: 600;\n                    color: #E65100;\n                    margin-right: 20px;\n                    position: relative;\n                    \n                    &:after {\n                        content: '';\n                        position: absolute;\n                        bottom: -6px;\n                        left: 0;\n                        width: 40px;\n                        height: 3px;\n                        background: linear-gradient(to right, #FF8A65, #FFB74D);\n                        border-radius: 3px;\n                    }\n                }\n                \n                .line-decoration {\n                    flex: 1;\n                    height: 1px;\n                    background: linear-gradient(to right, rgba(255, 138, 101, 0.2), rgba(255, 138, 101, 0.05));\n                }\n            }\n            \n            .notice-card {\n                position: relative;\n                margin-bottom: 30px;\n                padding-left: 50px;\n                display: block;\n                transition: all 0.3s;\n                \n                &:hover {\n                    transform: translateX(5px);\n                    \n                    .time-marker {\n                        transform: scale(1.1);\n                        box-shadow: 0 0 12px rgba(255, 183, 77, 0.3);\n                }\n                }\n                \n                /* 时间标记点 */\n                .time-marker {\n                    position: absolute;\n                    left: 10px;\n                    top: 0;\n                    width: 20px;\n                    height: 20px;\n                    background-color: #FFB74D;\n                    border: 3px solid #FFF3E0;\n                    border-radius: 50%;\n                    z-index: 1;\n                    transform-origin: center;\n                    transition: all 0.3s ease;\n                    box-shadow: 0 0 6px rgba(255, 183, 77, 0.2);\n                }\n                \n                .notice-content {\n                    background-color: #FFF3E0;\n                    border-radius: 6px;\n                    box-shadow: 0 1px 3px rgba(255, 165, 0, 0.08);\n                    border: 1px solid #FFE0B2;\n                    padding: 16px;\n                    overflow: hidden;\n                    \n                    .notice-date {\n                        display: inline-block;\n                        font-size: 14px;\n                        color: #FFFFFF;\n                        background-color: #FF8A65;\n                        padding: 4px 12px;\n                        border-radius: 15px;\n                        margin-bottom: 10px;\n                        font-weight: 500;\n                    }\n                        \n                        .notice-title {\n                            font-size: 18px;\n                            font-weight: 600;\n                        color: #E65100;\n                        margin: 0 0 12px 0;\n                            line-height: 1.4;\n                    }\n                    \n                    .notice-summary {\n                        margin-bottom: 16px;\n                        color: #424242;\n                        font-size: 14px;\n                        line-height: 1.6;\n                        position: relative;\n                        background: rgba(255, 243, 224, 0.5);\n                        padding: 12px;\n                        border-radius: 4px;\n                        border-left: 3px solid #FFB74D;\n                        \n                        .preview-content {\n                            position: relative;\n                            overflow: hidden;\n                            \n                            &::after {\n                                content: '';\n                                position: absolute;\n                                bottom: 0;\n                                left: 0;\n                                width: 100%;\n                                height: 24px;\n                                background: linear-gradient(to bottom, rgba(255, 243, 224, 0), rgba(255, 243, 224, 0.5));\n                                pointer-events: none;\n                            }\n                        }\n                        \n                        .preview-placeholder {\n                            color: #795548;\n                            font-style: italic;\n                        }\n                    }\n                    \n                    .btn-container {\n                        text-align: right;\n                    }\n                }\n            }\n        }\n    }\n    \n    .pagination-wrapper {\n        display: flex;\n        justify-content: center;\n        margin-top: 30px;\n        \n        ::v-deep .el-pagination {\n            padding: 12px 20px;\n            background: #FFF3E0;\n            border-radius: 6px;\n            box-shadow: 0 1px 3px rgba(255, 165, 0, 0.08);\n            border: 1px solid #FFE0B2;\n            \n            .el-pagination__sizes .el-input .el-input__inner {\n                border-radius: 4px;\n            background-color: rgba(255, 255, 255, 0.7);\n                border-color: #FFE0B2;\n            }\n            \n            button, .btn-prev, .btn-next {\n                border-radius: 4px;\n                transition: all 0.2s;\n                background-color: rgba(255, 255, 255, 0.5);\n                \n                &:hover {\n                    background-color: rgba(255, 183, 77, 0.2);\n                    color: #FF8A65;\n                }\n            }\n            \n            .el-pager li {\n                border-radius: 4px;\n                transition: all 0.2s;\n                background-color: rgba(255, 255, 255, 0.5);\n                \n                &:hover:not(.active) {\n                    background-color: rgba(255, 183, 77, 0.2);\n                    color: #FF8A65;\n                }\n                \n                &.active {\n                    background-color: #FFB74D;\n                    color: #fff;\n                    font-weight: bold;\n                }\n            }\n        }\n    }\n    \n    .el-empty {\n        margin: 100px 0;\n        transition: all 0.3s;\n        \n        ::v-deep .el-empty__image {\n            opacity: 0.8;\n        }\n        \n        ::v-deep .el-empty__description {\n            color: #909399;\n            font-size: 16px;\n    }\n}\n\n@media screen and (max-width: 768px) {\n    .notice-container {\n        .content-wrapper .notice-list .notice-card {\n            flex-direction: column;\n            \n            .notice-icon {\n                width: 100%;\n                height: 60px;\n            }\n            \n            .notice-main .notice-header {\n                flex-direction: column;\n                \n                .notice-date {\n                    margin-top: 8px;\n                }\n            }\n        }\n    }\n}\n\n/* 自定义Element UI按钮 */\n::v-deep .el-button--warning {\n    background-color: #ffb74d;\n    border-color: #ffb74d;\n    color: #fff;\n    \n    &:hover, &:focus {\n        background-color: #ff9800;\n        border-color: #ff9800;\n    }\n}\n\n.btn-container {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    margin-top: 15px;\n}\n\n/* 修改El-button样式为圆形带图标 */\n::v-deep .el-button--small.el-button--circle {\n    width: 36px;\n    height: 36px;\n    padding: 0;\n    margin-right: 8px;\n    box-shadow: 0 2px 4px rgba(255, 183, 77, 0.2);\n    \n    &:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(255, 183, 77, 0.3);\n    }\n    \n    i {\n        font-size: 16px;\n    }\n}\n\n.btn-text {\n    color: #ff8a65;\n    font-size: 14px;\n    font-weight: 500;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}