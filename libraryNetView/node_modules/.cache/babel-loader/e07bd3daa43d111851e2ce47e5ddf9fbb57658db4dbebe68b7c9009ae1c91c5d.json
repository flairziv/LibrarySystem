{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Toolbar = _resolveComponent(\"Toolbar\");\n  const _component_Editor = _resolveComponent(\"Editor\", true);\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_Toolbar, {\n    style: {\n      \"border-bottom\": \"1px solid #eae8e8\"\n    },\n    editor: $setup.editor,\n    defaultConfig: $setup.toolbarConfig,\n    mode: $setup.mode\n  }, null, 8, [\"editor\", \"defaultConfig\", \"mode\"]), _createVNode(_component_Editor, {\n    style: _normalizeStyle({\n      height: $props.height,\n      overflowY: 'hidden'\n    }),\n    modelValue: $setup.editorContent,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.editorContent = $event),\n    defaultConfig: $setup.editorConfig,\n    mode: $setup.mode,\n    onOnCreated: $setup.onCreated\n  }, null, 8, [\"style\", \"modelValue\", \"defaultConfig\", \"mode\", \"onOnCreated\"])]);\n}","map":{"version":3,"names":["_createElementBlock","_createVNode","_component_Toolbar","style","editor","$setup","defaultConfig","toolbarConfig","mode","_component_Editor","_normalizeStyle","height","$props","overflowY","editorContent","$event","editorConfig","onOnCreated","onCreated"],"sources":["E:\\code\\IntelliJ_IDEAProjects\\LibrarySystem\\libraryNetView\\src\\components\\Editor.vue"],"sourcesContent":["<template>\n    <div>\n        <Toolbar style=\"border-bottom: 1px solid #eae8e8;\" :editor=\"editor\" :defaultConfig=\"toolbarConfig\"\n            :mode=\"mode\" />\n        <Editor :style=\"{ height: height, overflowY: 'hidden' }\" v-model=\"editorContent\" :defaultConfig=\"editorConfig\"\n            :mode=\"mode\" @onCreated=\"onCreated\" />\n    </div>\n</template>\n<script>\nimport { ref, watch, onBeforeUnmount, defineProps, defineEmits } from 'vue'\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\n\nexport default {\n    name: 'Editor',\n    components: { Editor, Toolbar },\n    props: {\n        value: {\n            type: String,\n            default: '',\n        },\n        height: {\n            type: String,\n            default: 'calc(100vh - 250px)'\n        }\n    },\n    emits: ['input'],\n    setup(props, { emit }) {\n        const editor = ref(null)\n        const editorContent = ref(props.value || '<p>请输入内容...</p>')\n        const toolbarConfig = ref({})\n        const editorConfig = ref({\n            placeholder: '请输入内容...',\n            MENU_CONF: {\n                uploadImage: {\n                    server: '/api/library-system-api/v1.0/file/upload',\n                    fieldName: 'file',\n                    maxFileSize: 10 * 1024 * 1024,\n                    maxNumberOfFiles: 10,\n                    // allowedFileTypes: ['image/*'],\n                    metaWithUrl: false,\n                    withCredentials: true,\n                    timeout: 10 * 1000,\n                    headers: {\n                        'token': sessionStorage.getItem('token')\n                    },\n                    customInsert(res, insertFn) {\n                        insertFn(res.data, res.data, res.data);\n                    },\n                },\n                uploadVideo: {\n                    server: '/api/library-system-api/v1.0/file/upload',\n                    fieldName: 'file',\n                    maxFileSize: 100 * 1024 * 1024,\n                    headers: {\n                        'token': sessionStorage.getItem('token')\n                    },\n                    timeout: 60 * 1000,\n                    customInsert(res, insertFn) {\n                        insertFn(res.data, res.data);\n                    },\n                }\n            }\n        })\n        const mode = ref('default')\n\n        const onCreated = (editorInstance) => {\n            editor.value = Object.seal(editorInstance);\n            toolbarConfig.value.excludeKeys = ['group-video','insertLink','fullScreen','emotion','insertTable'];\n        }\n\n        // 监听 props.value 变化\n        watch(() => props.value, (newVal) => {\n            if (newVal !== editorContent.value) {\n                editorContent.value = newVal || '<p>请输入内容...</p>';\n            }\n        }, { immediate: true })\n\n        // 监听 editorContent 变化并发送事件\n        watch(editorContent, (newVal) => {\n            emit('input', newVal);\n        }, { deep: true })\n\n        onBeforeUnmount(() => {\n            const editorInstance = editor.value;\n            if (editorInstance == null) return;\n            editorInstance.destroy();\n        })\n\n        return {\n            editor,\n            editorContent,\n            toolbarConfig,\n            editorConfig,\n            mode,\n            onCreated\n        }\n    }\n}\n</script>\n<style src=\"@wangeditor/editor/dist/css/style.css\"></style>\n<style scoped>\n.line-number {\n    display: block;\n    margin-right: 10px;\n    /* 以下样式确保行号不被选中或复制 */\n    pointer-events: none;\n    user-select: none;\n    -webkit-user-select: none;\n    color: #999;\n    /* 行号颜色，可自定义 */\n    text-align: right;\n    /* 行号对齐方式 */\n}\n</style>\n"],"mappings":";;;;uBACIA,mBAAA,CAKM,cAJFC,YAAA,CACmBC,kBAAA;IADVC,KAAyC,EAAzC;MAAA;IAAA,CAAyC;IAAEC,MAAM,EAAEC,MAAA,CAAAD,MAAM;IAAGE,aAAa,EAAED,MAAA,CAAAE,aAAa;IAC5FC,IAAI,EAAEH,MAAA,CAAAG;oDACXP,YAAA,CAC0CQ,iBAAA;IADjCN,KAAK,EAAAO,eAAA;MAAAC,MAAA,EAAYC,MAAA,CAAAD,MAAM;MAAAE,SAAA;IAAA;gBAAkCR,MAAA,CAAAS,aAAa;+DAAbT,MAAA,CAAAS,aAAa,GAAAC,MAAA;IAAGT,aAAa,EAAED,MAAA,CAAAW,YAAY;IACxGR,IAAI,EAAEH,MAAA,CAAAG,IAAI;IAAGS,WAAS,EAAEZ,MAAA,CAAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}