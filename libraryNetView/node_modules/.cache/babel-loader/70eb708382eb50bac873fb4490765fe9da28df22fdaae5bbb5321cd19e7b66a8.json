{"ast":null,"code":"import { ref, watch, onBeforeUnmount, defineProps, defineEmits } from 'vue';\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue';\nexport default {\n  name: 'Editor',\n  components: {\n    Editor,\n    Toolbar\n  },\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    height: {\n      type: String,\n      default: 'calc(100vh - 250px)'\n    }\n  },\n  emits: ['input'],\n  setup(props, {\n    emit\n  }) {\n    const editor = ref(null);\n    const editorContent = ref(props.value || '<p>请输入内容...</p>');\n    const toolbarConfig = ref({});\n    const editorConfig = ref({\n      placeholder: '请输入内容...',\n      MENU_CONF: {\n        uploadImage: {\n          server: '/api/library-system-api/v1.0/file/upload',\n          fieldName: 'file',\n          maxFileSize: 10 * 1024 * 1024,\n          maxNumberOfFiles: 10,\n          // allowedFileTypes: ['image/*'],\n          metaWithUrl: false,\n          withCredentials: true,\n          timeout: 10 * 1000,\n          headers: {\n            'token': sessionStorage.getItem('token')\n          },\n          customInsert(res, insertFn) {\n            insertFn(res.data, res.data, res.data);\n          }\n        },\n        uploadVideo: {\n          server: '/api/library-system-api/v1.0/file/upload',\n          fieldName: 'file',\n          maxFileSize: 100 * 1024 * 1024,\n          headers: {\n            'token': sessionStorage.getItem('token')\n          },\n          timeout: 60 * 1000,\n          customInsert(res, insertFn) {\n            insertFn(res.data, res.data);\n          }\n        }\n      }\n    });\n    const mode = ref('default');\n    const onCreated = editorInstance => {\n      editor.value = Object.seal(editorInstance);\n      toolbarConfig.value.excludeKeys = ['group-video', 'insertLink', 'fullScreen', 'emotion', 'insertTable'];\n    };\n\n    // 监听 props.value 变化\n    watch(() => props.value, newVal => {\n      if (newVal !== editorContent.value) {\n        editorContent.value = newVal || '<p>请输入内容...</p>';\n      }\n    }, {\n      immediate: true\n    });\n\n    // 监听 editorContent 变化并发送事件\n    watch(editorContent, newVal => {\n      emit('input', newVal);\n    }, {\n      deep: true\n    });\n    onBeforeUnmount(() => {\n      const editorInstance = editor.value;\n      if (editorInstance == null) return;\n      editorInstance.destroy();\n    });\n    return {\n      editor,\n      editorContent,\n      toolbarConfig,\n      editorConfig,\n      mode,\n      onCreated\n    };\n  }\n};","map":{"version":3,"names":["ref","watch","onBeforeUnmount","defineProps","defineEmits","Editor","Toolbar","name","components","props","value","type","String","default","height","emits","setup","emit","editor","editorContent","toolbarConfig","editorConfig","placeholder","MENU_CONF","uploadImage","server","fieldName","maxFileSize","maxNumberOfFiles","metaWithUrl","withCredentials","timeout","headers","sessionStorage","getItem","customInsert","res","insertFn","data","uploadVideo","mode","onCreated","editorInstance","Object","seal","excludeKeys","newVal","immediate","deep","destroy"],"sources":["E:\\code\\IntelliJ_IDEAProjects\\LibrarySystem\\libraryNetView\\src\\components\\Editor.vue"],"sourcesContent":["<template>\n    <div>\n        <Toolbar style=\"border-bottom: 1px solid #eae8e8;\" :editor=\"editor\" :defaultConfig=\"toolbarConfig\"\n            :mode=\"mode\" />\n        <Editor :style=\"{ height: height, overflowY: 'hidden' }\" v-model=\"editorContent\" :defaultConfig=\"editorConfig\"\n            :mode=\"mode\" @onCreated=\"onCreated\" />\n    </div>\n</template>\n<script>\nimport { ref, watch, onBeforeUnmount, defineProps, defineEmits } from 'vue'\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\n\nexport default {\n    name: 'Editor',\n    components: { Editor, Toolbar },\n    props: {\n        value: {\n            type: String,\n            default: '',\n        },\n        height: {\n            type: String,\n            default: 'calc(100vh - 250px)'\n        }\n    },\n    emits: ['input'],\n    setup(props, { emit }) {\n        const editor = ref(null)\n        const editorContent = ref(props.value || '<p>请输入内容...</p>')\n        const toolbarConfig = ref({})\n        const editorConfig = ref({\n            placeholder: '请输入内容...',\n            MENU_CONF: {\n                uploadImage: {\n                    server: '/api/library-system-api/v1.0/file/upload',\n                    fieldName: 'file',\n                    maxFileSize: 10 * 1024 * 1024,\n                    maxNumberOfFiles: 10,\n                    // allowedFileTypes: ['image/*'],\n                    metaWithUrl: false,\n                    withCredentials: true,\n                    timeout: 10 * 1000,\n                    headers: {\n                        'token': sessionStorage.getItem('token')\n                    },\n                    customInsert(res, insertFn) {\n                        insertFn(res.data, res.data, res.data);\n                    },\n                },\n                uploadVideo: {\n                    server: '/api/library-system-api/v1.0/file/upload',\n                    fieldName: 'file',\n                    maxFileSize: 100 * 1024 * 1024,\n                    headers: {\n                        'token': sessionStorage.getItem('token')\n                    },\n                    timeout: 60 * 1000,\n                    customInsert(res, insertFn) {\n                        insertFn(res.data, res.data);\n                    },\n                }\n            }\n        })\n        const mode = ref('default')\n\n        const onCreated = (editorInstance) => {\n            editor.value = Object.seal(editorInstance);\n            toolbarConfig.value.excludeKeys = ['group-video','insertLink','fullScreen','emotion','insertTable'];\n        }\n\n        // 监听 props.value 变化\n        watch(() => props.value, (newVal) => {\n            if (newVal !== editorContent.value) {\n                editorContent.value = newVal || '<p>请输入内容...</p>';\n            }\n        }, { immediate: true })\n\n        // 监听 editorContent 变化并发送事件\n        watch(editorContent, (newVal) => {\n            emit('input', newVal);\n        }, { deep: true })\n\n        onBeforeUnmount(() => {\n            const editorInstance = editor.value;\n            if (editorInstance == null) return;\n            editorInstance.destroy();\n        })\n\n        return {\n            editor,\n            editorContent,\n            toolbarConfig,\n            editorConfig,\n            mode,\n            onCreated\n        }\n    }\n}\n</script>\n<style src=\"@wangeditor/editor/dist/css/style.css\"></style>\n<style scoped>\n.line-number {\n    display: block;\n    margin-right: 10px;\n    /* 以下样式确保行号不被选中或复制 */\n    pointer-events: none;\n    user-select: none;\n    -webkit-user-select: none;\n    color: #999;\n    /* 行号颜色，可自定义 */\n    text-align: right;\n    /* 行号对齐方式 */\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}